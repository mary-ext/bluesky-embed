import{p as e,t,s as a,a as s,b as i,c as r,d as l,e as o,f as n,g as d,B as c,h as p,i as u,j as m,k as f,l as h,C as v,m as b}from"./index-cNEJntuD.js";import{X as k,s as y,a as $,h as g,o as w,G as x,b as z,C as q,n as Z,r as A,e as F}from"./GuideInstructions-4EcnyWdt.js";import{s as C}from"./index-Cr8Vao8y.js";const M=/[&"<]/g,N=/[&<]/g;function _(e,t){const a=String(e??""),s=t?M:N;s.lastIndex=0;let i="",r=0;for(;s.test(a);){const e=s.lastIndex-1,t=a[e];i+=a.substring(r,e)+("&"===t?"&amp;":'"'===t?"&quot;":"&lt;"),r=e+1}return i+a.substring(r)}function B(e,t,a=!1){if(null==t||!t&&a||""===t&&"class"===e)return"";return` ${e}${a?"":`="${_(t,!0)}"`}`}function U(e){return"string"==typeof e?e:null==e?"":e+""}function S(e,t){const{children:a}=t;e.out+='<div class="bluesky-embed s-3olstj">',a(e),e.out+="</div>"}const T=e=>`https://bsky.app/profile/${e}`,I=(e,t)=>`https://bsky.app/profile/${e}/post/${t}`,R=(e,t)=>`https://bsky.app/profile/${e}/feed/${t}`;let D=0,H=0;const j=new Intl.DateTimeFormat("en-US",{dateStyle:"long",timeStyle:"short"}),P=new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}),V=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}),G=e=>{const t=new Date(e),a=t.getTime();if(isNaN(a))return"N/A";const s=Date.now();if(s>H){const e=new Date(s);e.setMonth(0,1),e.setHours(0,0,0),D=e.getTime(),e.setFullYear(e.getFullYear()+1,0,0),e.setHours(23,59,59,999),H=e.getTime()}return a>=D&&a<=H?V.format(t):P.format(t)},L=e=>{const t=new Date(e);return isNaN(t.getTime())?"N/A":j.format(t)},W={"!hide":{name:"Hidden by moderators",flags:1},"!warn":{name:"Content warning",flags:1},porn:{name:"Adult content",flags:0},sexual:{name:"Sexually suggestive",flags:0},"graphic-media":{name:"Graphic media",flags:0},nudity:{name:"Nudity",flags:0}},E=(e,t)=>{if(e?.length)for(let a=0,s=e.length;a<s;a++){const s=e[a],i=s.val;if(!(i in W))continue;const r=W[i];if(!(1&r.flags&&s.src===t))return r}},Y=new Intl.NumberFormat("en-US"),J=new Intl.NumberFormat("en-US",{notation:"compact"}),K=e=>e<1e3?""+e:e<1e5?Y.format(e):J.format(e),X=e=>Y.format(e),O=/^at:\/\/((?:did:[a-zA-Z0-9._:%-]+)|(?:[a-zA-Z0-9][a-zA-Z0-9-.]*))(?:\/([a-zA-Z0-9.-]+)(?:\/([a-zA-Z0-9_~.:-]{1,512}))?)?\/?(?:\?([^#\s]*))?(?:#([^\s]*))?$/,Q=e=>{const t=O.exec(e);if(!t)throw new ee(`invalid at-uri: ${e}`);return{repo:t[1],collection:t[2]??"",rkey:t[3]??"",query:t[4]??"",fragment:t[5]??""}};let ee=class extends Error{};function te(e,t){const{embed:a}=t,s=a.external,i=(e=>{let t;if("parse"in URL)t=URL.parse(e);else try{t=new URL(e)}catch{}return!t||"https:"!==t.protocol&&"http:"!==t.protocol?null:t})(s.uri)?.host;e.out+=`<a target="_blank"${B("href",i&&s.uri)} rel="noopener noreferrer nofollow" class="external-embed s-rtbqd8">`,s.thumb&&(e.out+=`<img loading="lazy"${B("src",s.thumb)} alt="" class="thumbnail s-rtbqd8">`),e.out+=` <div class="meta s-rtbqd8"><p class="title s-rtbqd8">${_(s.title)}</p> <p class="description s-rtbqd8">${_(s.description)}</p> `,i&&(e.out+=`<div class="domain s-rtbqd8"><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m4.172 8.07 3.94 2.957.977-1.941 3.887-.978 1.15-4.6M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-6.078 4.865.973-1.946-2.869-1.928-1.89-.12-1.08 1.075 1.947 2.919h2.919Z"></path></svg> <span class="domain-name">${_(i)}</span></div>`),e.out+="</div></a>"}function ae(e,t){const{embed:a,borderless:s,standalone:i,blur:r}=t,l=a.images,o=l.length;function n(e,t){const a=l[t];e.out+=`<img loading="lazy"${B("src",a.thumb)}${B("alt",a.alt)}${B("class",`${U("image"+(r?" is-blurred":""))} s-t3k6fc`)}>`}if(e.out+=`<div${B("class",`${U("image-embed"+(s?"":" is-bordered")+(i&&1===o?" is-aligned":""))} s-t3k6fc`)}>`,4===o)e.out+='<div class="grid s-t3k6fc"><div class="col s-t3k6fc"><div class="item wide tl s-t3k6fc">',n(e,0),e.out+='</div> <div class="item wide bl s-t3k6fc">',n(e,2),e.out+='</div></div> <div class="col s-t3k6fc"><div class="item wide tr s-t3k6fc">',n(e,1),e.out+='</div> <div class="item wide br s-t3k6fc">',n(e,3),e.out+="</div></div></div>";else if(3===o)e.out+='<div class="grid s-t3k6fc"><div class="col square s-t3k6fc"><div class="item tl bl s-t3k6fc">',n(e,0),e.out+='</div></div> <div class="col square s-t3k6fc"><div class="item tr s-t3k6fc">',n(e,1),e.out+='</div> <div class="item br s-t3k6fc">',n(e,2),e.out+="</div></div></div>";else if(2===o)e.out+='<div class="grid s-t3k6fc"><div class="col s-t3k6fc"><div class="item square tl bl s-t3k6fc">',n(e,0),e.out+='</div></div> <div class="col s-t3k6fc"><div class="item square tr br s-t3k6fc">',n(e,1),e.out+="</div></div></div>";else if(1===o){const t=i&&l[0].aspectRatio;e.out+=`<div${B("class",`${U("single-item tl tr bl br"+(t?" is-standalone":""))} s-t3k6fc`)}${B("style",t?`aspect-ratio: ${t.width}/${t.height}`:"")}>`,n(e,0),e.out+=" ",t&&(e.out+='<div class="placeholder s-t3k6fc"></div>'),e.out+="</div>"}e.out+="</div>"}function se(e,t){const{post:a,embed:s,borderless:i,standalone:r,blur:l}=t,o=r&&s.aspectRatio,n=a&&I(a.author.did,Q(a.uri).rkey);function d(e){e.out+=`<img loading="lazy"${B("src",s.thumbnail)} alt=""${B("class",`${U("thumbnail"+(l?" is-blurred":""))} s-1azk58e`)}> `,o&&(e.out+='<div class="placeholder s-1azk58e"></div>'),e.out+=' <div class="play s-1azk58e"><svg class="icon s-1azk58e" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12 5 2v20l17-10Z"></path></svg></div>'}r?(e.out+=`<a target="_blank"${B("href",n)}${B("class",`${U("video-embed"+(i?"":" is-bordered")+(r?" is-standalone":""))} s-1azk58e`)}><div class="constrainer s-1azk58e"${B("style",o?`aspect-ratio: ${o.width}/${o.height}`:"")}>`,d(e),e.out+="</div></a>"):(e.out+=`<div${B("class",`${U("video-embed"+(i?"":" is-bordered"))} s-1azk58e`)}${B("style",o?`aspect-ratio: ${o.width}/${o.height}`:"")}>`,d(e),e.out+="</div>")}const ie=e=>{if(e){if("app.bsky.embed.images#view"===e.$type)return e;if("app.bsky.embed.recordWithMedia#view"===e.$type)return ie(e.media)}},re=e=>{if(e){if("app.bsky.embed.video#view"===e.$type)return e;if("app.bsky.embed.recordWithMedia#view"===e.$type)return re(e.media)}};function le(e,t){e.out+=`<div class="message s-azdpbr">${_(t)}</div>`}function oe(e,t){const{post:a,embed:s,large:i=!1}=t;function r(e,t){!function(e,t){const{warning:a,children:s}=t;a?(e.out+=`<details class="content-hider s-q6x07m"><summary class="gate s-q6x07m"><svg class="icon s-q6x07m" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="M11 11h1v5m9-4a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path><path fill="currentColor" stroke="currentColor" stroke-width=".5" d="M11.5 7.25h-.25v1.5h1.5v-1.5H11.5Z"></path></svg> <span class="label s-q6x07m">${_(a.name)}</span> <span class="action s-q6x07m"></span></summary> `,s(e),e.out+="</details>"):s(e)}(e,{warning:a&&E(a.labels,a.author.did),children:e=>{"app.bsky.embed.external#view"===t.$type?te(e,{embed:t}):"app.bsky.embed.images#view"===t.$type?ae(e,{embed:t,standalone:!0}):"app.bsky.embed.video#view"===t.$type?se(e,{post:a,embed:t,standalone:!0}):le(e,"Unsupported media embed")}})}function l(e,t){const a=t.record;if("app.bsky.embed.record#viewRecord"===a.$type)!function(e,t){const{embed:a,large:s=!1}=t,i=a.value,r=i.text.trim(),l=a.author,o=l.displayName?.trim(),n=a.embeds?.[0],d=ie(n),c=re(n),p=I(l.did,Q(a.uri).rkey),u=!!E(a.labels,l.did);e.out+=`<a target="_blank"${B("href",p)} class="quote-embed s-za6fip"><div class="meta s-za6fip"><div class="avatar-wrapper s-za6fip">`,l.avatar&&(e.out+=`<img loading="lazy"${B("src",l.avatar)} alt="" class="avatar s-za6fip">`),e.out+='</div> <span class="name-wrapper s-za6fip">',o&&(e.out+=`<bdi class="display-name-wrapper s-za6fip"><span class="display-name s-za6fip">${_(o)}</span></bdi>`),e.out+=` <span class="handle s-za6fip">@${_(l.handle)}</span></span> <span aria-hidden="true" class="dot s-za6fip">·</span> <time${B("datetime",i.createdAt)} class="date s-za6fip">${_(G(i.createdAt))}</time></div> `,r?(e.out+='<div class="body s-za6fip">',s||(d?(e.out+='<div class="aside s-za6fip">',ae(e,{embed:d,blur:u}),e.out+="</div>"):c&&(e.out+='<div class="aside s-za6fip">',se(e,{embed:c,blur:u}),e.out+="</div>")),e.out+=` <p class="text s-za6fip">${_(r)}</p></div>`):e.out+='<div class="divide s-za6fip"></div>',e.out+=" ",!s&&r||(d?ae(e,{embed:d,borderless:!0,blur:u}):c&&se(e,{embed:c,borderless:!0,blur:u})),e.out+="</a>"}(e,{embed:a,large:i});else if("app.bsky.feed.defs#generatorView"===a.$type)!function(e,t){const{embed:a}=t,s=a.creator,i=R(s.did,Q(a.uri).rkey);e.out+=`<a target="_blank"${B("href",i)} class="feed-embed s-156tlwp"><div class="main s-156tlwp"><div class="avatar-wrapper s-156tlwp">`,a.avatar?e.out+=`<img loading="lazy"${B("src",a.avatar)} alt="" class="avatar s-156tlwp">`:e.out+='<svg viewBox="0 0 32 32" class="avatar s-156tlwp"><path fill="#0070FF" d="M0 0h32v32H0z"></path><path fill="#fff" d="M22.153 22.354a9.328 9.328 0 0 0 3.837-.491 3.076 3.076 0 0 0-4.802-2.79m.965 3.281a6.128 6.128 0 0 0-.965-3.28Zm-11.342-3.28a3.077 3.077 0 0 0-4.801 2.79 9.21 9.21 0 0 0 3.835.49m.966-3.28a6.127 6.127 0 0 0-.966 3.28Zm8.265-8.997a3.076 3.076 0 1 1-6.153 0 3.076 3.076 0 0 1 6.153 0Zm6.154 3.077a2.307 2.307 0 1 1-4.615 0 2.307 2.307 0 0 1 4.615 0Zm-13.847 0a2.307 2.307 0 1 1-4.614 0 2.307 2.307 0 0 1 4.614 0Z"></path><path fill="#fff" d="M22 22c0 3.314-2.686 3.5-6 3.5s-6-.186-6-3.5a6 6 0 0 1 12 0Z"></path></svg>',e.out+=`</div> <div class="info"><p class="name s-156tlwp">${_(a.displayName)}</p> <p class="creator s-156tlwp">Feed by @${_(s.handle)}</p></div></div> <p class="description s-156tlwp">${_(a.description)}</p></a>`}(e,{embed:a});else if("app.bsky.graph.defs#listView"===a.$type)!function(e,t){const{embed:a}=t,s=a.creator,i=R(s.did,Q(a.uri).rkey);e.out+=`<a target="_blank"${B("href",i)} class="list-embed s-6uize5"><div class="main s-6uize5"><div class="avatar-wrapper s-6uize5">`,a.avatar?e.out+=`<img loading="lazy"${B("src",a.avatar)} alt="" class="avatar s-6uize5">`:e.out+='<svg viewBox="0 0 32 32" class="avatar s-6uize5"><path fill="#0070FF" d="M0 0h32v32H0z"></path><path fill="#fff" d="M22.153 22.354a9.328 9.328 0 0 0 3.837-.491 3.076 3.076 0 0 0-4.802-2.79m.965 3.281a6.128 6.128 0 0 0-.965-3.28Zm-11.342-3.28a3.077 3.077 0 0 0-4.801 2.79 9.21 9.21 0 0 0 3.835.49m.966-3.28a6.127 6.127 0 0 0-.966 3.28Zm8.265-8.997a3.076 3.076 0 1 1-6.153 0 3.076 3.076 0 0 1 6.153 0Zm6.154 3.077a2.307 2.307 0 1 1-4.615 0 2.307 2.307 0 0 1 4.615 0Zm-13.847 0a2.307 2.307 0 1 1-4.614 0 2.307 2.307 0 0 1 4.614 0Z"></path><path fill="#fff" d="M22 22c0 3.314-2.686 3.5-6 3.5s-6-.186-6-3.5a6 6 0 0 1 12 0Z"></path></svg>',e.out+=`</div> <div class="info"><p class="name s-6uize5">${_(a.name)}</p> <p class="creator s-6uize5">${_((e=>{switch(e){case"app.bsky.graph.defs#curatelist":return"User list";case"app.bsky.graph.defs#modlist":return"Moderation list"}return"Unknown list"})(a.purpose))} by @${_(s.handle)}</p></div></div> <p class="description s-6uize5">${_(a.description)}</p></a>`}(e,{embed:a});else if("app.bsky.graph.defs#starterPackViewBasic"===a.$type)!function(e,t){const{embed:a,large:s=!1}=t,i=a.record,r=a.creator,l=r.did,o=Q(a.uri).rkey,n=((e,t)=>`https://bsky.app/starter-pack/${e}/${t}`)(l,o);if(e.out+=`<a target="_blank"${B("href",n)} class="starterpack-embed s-15v965v">`,s){const t=((e,t)=>`https://ogcard.cdn.bsky.app/start/${e}/${t}`)(l,o);e.out+=`<img loading="lazy"${B("src",t)} alt="" class="banner s-15v965v">`}e.out+=` <div class="meta s-15v965v"><div class="main s-15v965v"><svg fill="none" viewBox="0 0 24 24" class="avatar s-15v965v"><defs><linearGradient id="a" x1="0" x2="100%" y1="0" y2="0" gradientTransform="rotate(45)"><stop offset="0" stop-color="#0A7AFF"></stop><stop offset="1" stop-color="#59B9FF"></stop></linearGradient></defs><path fill="url(#a)" fill-rule="evenodd" d="M11.26 5.227 5.02 6.899c-.734.197-1.17.95-.973 1.685l1.672 6.24c.197.734.951 1.17 1.685.973l6.24-1.672a1.376 1.376 0 0 0 .973-1.685L12.945 6.2a1.375 1.375 0 0 0-1.685-.973Zm-6.566.459a2.632 2.632 0 0 0-1.86 3.223l1.672 6.24a2.632 2.632 0 0 0 3.223 1.861l6.24-1.672a2.631 2.631 0 0 0 1.861-3.223l-1.672-6.24a2.632 2.632 0 0 0-3.223-1.861l-6.24 1.672Z" clip-rule="evenodd"></path><path fill="url(#a)" fill-rule="evenodd" d="M15.138 18.411a4.606 4.606 0 1 0 0-9.211 4.606 4.606 0 0 0 0 9.211Zm0 1.257a5.862 5.862 0 1 0 0-11.724 5.862 5.862 0 0 0 0 11.724Z" clip-rule="evenodd"></path></svg> <div class="info"><p class="name s-15v965v">${_(i.name)}</p> <p class="creator s-15v965v">Starter pack by @${_(r.handle)}</p></div></div> <p class="description s-15v965v">${_(i.description)}</p></div></a>`}(e,{embed:a,large:i});else{const t=(e=>{switch(e){case"app.bsky.feed.post":return"post";case"app.bsky.feed.generator":return"feed";case"app.bsky.graph.list":return"list";case"app.bsky.graph.starterpack":return"starter pack";case"app.bsky.labeler.service":return"labeler"}return null})(Q(a.uri).collection);le(e,t&&("app.bsky.embed.record#viewNotFound"===a.$type||"app.bsky.embed.record#viewBlocked"===a.$type||"app.bsky.embed.record#viewDetached"===a.$type)?`This ${t} is unavailable`:"Unsupported record embed")}}e.out+='<div class="embeds s-azdpbr">',"app.bsky.embed.recordWithMedia#view"===s.$type?(r(e,s.media),e.out+=" ",l(e,s.record)):"app.bsky.embed.record#view"===s.$type?l(e,s):r(e,s),e.out+="</div>"}function ne(e,t){const{text:a,facets:s,large:i}=t,r=C(a,s);e.out+=`<p${B("class",`${U("rich-text"+(i?" is-large":" is-small"))} s-1lecfnd`)}>`;for(let n=0,d=r.length;n<d;n++){let t=r[n];const a=(o=t.features,o?.find((e=>"app.bsky.richtext.facet#link"===e.$type||"app.bsky.richtext.facet#mention"===e.$type||"app.bsky.richtext.facet#tag"===e.$type)));a?"app.bsky.richtext.facet#link"===a.$type?e.out+=`<a target="_blank"${B("href",a.uri)} rel="noopener nofollow" class="link s-1lecfnd">${_(t.text)}</a>`:"app.bsky.richtext.facet#mention"===a.$type?e.out+=`<a target="_blank"${B("href",T(a.did))} class="mention s-1lecfnd">${_(t.text)}</a>`:"app.bsky.richtext.facet#tag"===a.$type&&(e.out+=`<a target="_blank"${B("href",(l=a.tag,`https://bsky.app/hashtag/${l}`))} class="hashtag s-1lecfnd">${_(t.text)}</a>`):e.out+=_(t.text)}var l,o;e.out+="</p>"}function de(e,t){const{post:a,parent:s,prev:i=!1}=t,r=a.author,l=T(r.did),o=r.displayName?.trim(),n=a.record,d=I(r.did,Q(a.uri).rkey),c=a.replyCount||0,p=a.likeCount||0,u=(a.repostCount||0)+(a.quoteCount||0),m=!!E(r.labels,r.did);if(e.out+=`<div class="highlighted-post s-hik11q"><div class="meta s-hik11q"><a${B("href",l)} target="_blank" class="avatar-wrapper s-hik11q">`,r.avatar&&(e.out+=`<img loading="lazy"${B("src",r.avatar)} alt=""${B("class",`${U("avatar"+(m?" is-blurred":""))} s-hik11q`)}>`),e.out+=`</a> <a${B("href",l)} target="_blank" class="name-wrapper s-hik11q">`,o&&(e.out+=`<bdi class="display-name-wrapper s-hik11q"><span class="display-name s-hik11q">${_(o)}</span></bdi>`),e.out+=` <span class="handle s-hik11q">@${_(r.handle)}</span></a> `,i||(e.out+='<svg class="logo s-hik11q" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg>'),e.out+="</div> ",!i&&n.reply){if(e.out+='<p class="context s-hik11q">',s){const t=s.author;e.out+=`Replying to <a target="_blank"${B("href",T(t.did))} dir="auto" class="s-hik11q">${_(t.displayName?.trim()||`@${t.handle}`)}</a>`}else e.out+="Replying to an unknown post";e.out+="</p>"}e.out+=" ",ne(e,{text:n.text,facets:n.facets,large:!0}),e.out+=" ",a.embed&&oe(e,{post:a,embed:a.embed,large:!0}),e.out+=` <time${B("datetime",n.createdAt)} class="date s-hik11q">${_(L(n.createdAt))}</time> <div class="stats s-hik11q"><span class="stat s-hik11q"${B("title",1===p?`${X(p)} like`:`${X(p)} likes`)}><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M12 5.768c6.162-6.25 16.725 5.358 0 14.732C-4.725 11.126 5.838-.482 12 5.768Z"></path></svg> <span>${_(K(p))}</span></span> <span class="stat s-hik11q"${B("title",1===u?`${X(u)} repost`:`${X(u)} reposts`)}><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="m17 3 3 3-3 3M7 21l-3-3 3-3m-2 3h15v-5M4 11V6h15"></path></svg> <span>${_(K(u))}</span></span> <div class="gap s-hik11q"></div> <a${B("href",d)} target="_blank" class="permalink s-hik11q"><span>${_(c?1===c?`Read ${K(c)} reply on Bluesky`:`Read ${K(c)} replies on Bluesky`:"View on Bluesky")}</span></a></div></div>`}function ce(e,t){const{post:a,parent:s,prev:i}=t,r=a.author,l=T(r.did),o=r.displayName?.trim(),n=a.record,d=I(r.did,Q(a.uri).rkey),c=!!E(r.labels,r.did);if(e.out+='<div class="post s-12mzi62">',i||(e.out+='<svg class="logo s-12mzi62" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg>'),e.out+=` <div class="aside s-12mzi62"><a target="_blank"${B("href",l)} class="avatar-wrapper s-12mzi62">`,r.avatar&&(e.out+=`<img loading="lazy"${B("src",r.avatar)} alt=""${B("class",`${U("avatar"+(c?" is-blurred":""))} s-12mzi62`)}>`),e.out+=`</a> <div class="line s-12mzi62"></div></div> <div class="main s-12mzi62"><div class="meta s-12mzi62"><a${B("href",l)} target="_blank" class="name-wrapper s-12mzi62">`,o&&(e.out+=`<bdi class="display-name-wrapper s-12mzi62"><span class="display-name s-12mzi62">${_(o)}</span></bdi>`),e.out+=` <span class="handle s-12mzi62">@${_(r.handle)}</span></a> <span aria-hidden="true" class="dot s-12mzi62">·</span> <a target="_blank"${B("href",d)}${B("title",L(n.createdAt))} class="date s-12mzi62"><time${B("datetime",n.createdAt)}>${_(G(n.createdAt))}</time></a></div> `,!i&&n.reply){if(e.out+='<p class="context s-12mzi62">',s){const t=s.author;e.out+=`Replying to <a target="_blank"${B("href",T(t.did))} dir="auto" class="s-12mzi62">${_(t.displayName?.trim()||`@${t.handle}`)}</a>`}else e.out+="Replying to an unknown post";e.out+="</p>"}e.out+=" ",ne(e,{text:n.text,facets:n.facets}),e.out+=" ",a.embed&&oe(e,{post:a,embed:a.embed}),e.out+="</div></div>"}function pe(e,t){S(e,{children:e=>{e.out+=`<div class="message s-1q9cbx0">${_(t)}</div>`}})}function ue(e,t){const{thread:a,contextless:s,allowUnauthenticated:i}=t,r=!i&&null!==a&&"app.bsky.feed.defs#threadViewPost"===a.$type&&a.post.author.labels?.some((e=>"!no-unauthenticated"===e.val));if(null===a)pe(e,"The post can't be found, it may have been deleted.");else if(r)pe(e,"The author has requested for their posts to not be displayed on external sites.");else{const t=((e,t,a)=>{const s=[];let i=0,r=t?1:2,l=e;for(;l&&"app.bsky.feed.defs#notFoundPost"!==l.$type&&"app.bsky.feed.defs#blockedPost"!==l.$type;){const e=l.post;if(0!==i&&(s[i-1].parent=e),++i>r)break;const t=e.author;if(!a&&t.labels?.some((e=>"!no-unauthenticated"===e.val)))break;s.push({post:e,parent:null}),l=l.parent}return s.reverse()})(a,s,i);S(e,{children:e=>{const a=t;for(let s=0,i=a.length;s<i;s++){let{post:i,parent:r}=a[s];const l=0!==s;s===t.length-1?de(e,{post:i,parent:r,prev:l}):ce(e,{post:i,parent:r,prev:l})}}})}}const me=new Intl.DateTimeFormat("en-US",{dateStyle:"long",timeStyle:"short"}),fe=/^at:\/\/((?:did:[a-zA-Z0-9._:%-]+)|(?:[a-zA-Z0-9][a-zA-Z0-9-.]*))(?:\/([a-zA-Z0-9.-]+)(?:\/([a-zA-Z0-9_~.:-]{1,512}))?)?\/?(?:\?([^#\s]*))?(?:#([^\s]*))?$/;class he extends Error{}var ve=r("<bluesky-post><!></bluesky-post>",2);function be(r,o){e(o,!0);var n=ve(),d=l(n);g(d,(()=>function(e,t){const a={out:""};return ue(a,t?.props??{}),{head:"",body:a.out}}(0,{props:o.data}).body)),t((()=>a(n,"src",o.data.thread?.post.uri))),s(r,n),i()}var ke=r('Doing server-side rendering? Check out examples for <a href="https://github.com/mary-ext/bluesky-embed-astro">Astro</a> and <a href="https://github.com/mary-ext/bluesky-embed-sveltekit">SvelteKit</a>.',1),ye=r("<li><p>Insert the following scripts and stylesheets to the <code>&lt;head&gt;</code> of your website.</p> <!></li> <li><p>Insert the following markup in wherever you want the post to be.</p> <!></li>",1),$e=r("<!> <!>",1),ge=r("<!> <!>",1);function we(a,r){let g;e(r,!0);const C=b((()=>{g?.abort(),g=new AbortController;const e=g.signal;return(async e=>{const t=new k({handler:y({service:e.serviceUri??"https://public.api.bsky.app"})}),a=e.contextless??!1,{data:s}=await t.get("app.bsky.feed.getPostThread",{signal:e.signal,params:{uri:e.uri,parentHeight:a?1:2,depth:0}}).catch((e=>e instanceof $&&"NotFound"===e.kind?{data:null}:Promise.reject(e)));return{thread:"app.bsky.feed.defs#threadViewPost"===s?.thread.$type?s.thread:null,contextless:a,allowUnauthenticated:e.allowUnauthenticated??!1}})({uri:`at://${r.matched.author}/app.bsky.feed.post/${r.matched.rkey}`,signal:e})}));w((()=>{g?.abort()}));const M="https://cdn.jsdelivr.net/npm/bluesky-post-embed@^1.0.0",N=()=>`\x3c!-- Core web component and styling --\x3e\n<script type="module" src="${M}/+esm"><\/script>\n<link rel="stylesheet" href="${M}/dist/core.min.css">\n\n\x3c!-- Built-in themes --\x3e\n<link rel="stylesheet" href="${M}/themes/light.min.css" media="(prefers-color-scheme: light)">\n<link rel="stylesheet" href="${M}/themes/dim.min.css" media="(prefers-color-scheme: dark)">\n\n\x3c!-- Fallback/placeholder elements if JS script is taking a while to load or is failing --\x3e\n<style>\n  .bluesky-post-fallback {\n    margin: 16px 0;\n    border-left: 3px solid var(--divider);\n    padding: 4px 8px;\n    white-space: pre-wrap;\n    overflow-wrap: break-word;\n  }\n  .bluesky-post-fallback p {\n    margin: 0 0 8px 0;\n  }\n</style>\n`,_=e=>{const t=e.author,a=e.record;return`<bluesky-post src="${F(e.uri)}">\n  <blockquote class="bluesky-post-fallback">\n    <p dir="auto">${F(a.text)}</p>\n    — ${t.displayName?.trim()?`${F(t.displayName)} (@${F(t.handle)})`:`@${F(t.handle)}`}\n    <a href="${F(((e,t)=>`https://bsky.app/profile/${e}/post/${t}`)(t.did,(e=>{const t=fe.exec(e);if(!t)throw new he(`invalid at-uri: ${e}`);return{repo:t[1],collection:t[2]??"",rkey:t[3]??"",query:t[4]??"",fragment:t[5]??""}})(e.uri).rkey))}">${(e=>{const t=new Date(e);return isNaN(t.getTime())?"N/A":me.format(t)})(e.indexedAt)}</a>\n  </blockquote>\n</bluesky-post>\n`};var B=o(),U=n(B);d(U,(()=>m(C)),(e=>{v(e,{})}),((e,t)=>{var a=ge(),i=n(a);be(i,{get data(){return m(t)}});var r=f(i,2),o=e=>{x(e,{title:"How do I embed this to my website?",children:(e,a)=>{var i=$e(),r=n(i);c(r,{type:"inform",children:(e,t)=>{Z();var a=ke();Z(4),s(e,a)},$$slots:{default:!0}});var o=f(r,2);z(o,{children:(e,a)=>{var i=ye(),r=n(i),o=f(l(r),2),d=b(N);q(o,{get code(){return m(d)}}),A(r);var c=f(r,2),p=f(l(c),2),u=b((()=>_(m(t).thread.post)));q(p,{get code(){return m(u)}}),A(c),s(e,i)},$$slots:{default:!0}}),s(e,i)},$$slots:{default:!0}})};h(r,(e=>{m(t).thread&&e(o)})),s(e,a)}),((e,a)=>{c(e,{type:"alert",children:(e,i)=>{Z();var r=p();t((()=>u(r,""+m(a)))),s(e,r)},$$slots:{default:!0}})})),s(a,B),i()}export{we as default};
