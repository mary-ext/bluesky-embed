import{p as e,t,s,a,b as n,c as r,d as l,e as o,f as i,g as c,B as p,h as d,i as u,j as f,k as h,m,l as b,C as g}from"./index-xYaDyaLn.js";import{X as w,s as y,a as v,h as $,o as k,n as x,G as q,b as C,C as F,r as I,e as N}from"./GuideInstructions-lu6IsfjL.js";const A=/^[@＠]([a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*(?:\.[a-zA-Z]{2,}))($|\s|\p{P})/u,P=/^(?:#(?!\ufe0f|\u20e3)|＃)([\p{N}]*[\p{L}\p{M}\p{Pc}][\p{L}\p{M}\p{Pc}\p{N}]*)($|\s|\p{P})/u,B=/^:([\w-]+):/,U=/^https?:\/\/[\S]+/,_=/(?:(?<!\(.*)\))?[.,;]*$/,j=/^\[((?:\[(?:\\.|[^\[\]\\])*\]|\\.|[^\[\]\\])*?)\]\((.*?)\)/,z=/^\\([@＠#:\\\[])/,S=/^.+?(?:(?=$|[:\\\[]|https?:\/\/)|(?<=\s|[(){}\/\\\[\]\-|:;'".,=+])(?=[@＠#＃]))/s,M=e=>{const t=A.exec(e);if(t&&"@"!==t[2]){const e=t[2].length;return{type:"mention",raw:e>0?t[0].slice(0,-e):t[0],handle:t[1]}}},Z=e=>{const t=P.exec(e);if(t&&"#"!==t[2]){const e=t[2].length;return{type:"topic",raw:e>0?t[0].slice(0,-e):t[0],name:t[1]}}},G=e=>{const t=B.exec(e);if(t)return{type:"emote",raw:t[0],name:t[1]}},H=e=>{const t=U.exec(e);if(t){const e=t[0].replace(_,"");return{type:"autolink",raw:e,url:e}}},L=e=>{const t=j.exec(e);if(t)return{type:"link",raw:t[0],text:t[1],url:t[2]}},T=e=>{const t=z.exec(e);if(t)return{type:"escape",raw:t[0],escaped:t[1]}},E=e=>{const t=S.exec(e);if(t)return{type:"text",raw:t[0],text:t[0]}},R=/[&"<]/g,X=/[&<]/g;function D(e,t){const s=String(e??""),a=t?R:X;a.lastIndex=0;let n="",r=0;for(;a.test(s);){const e=a.lastIndex-1,t=s[e];n+=s.substring(r,e)+("&"===t?"&amp;":'"'===t?"&quot;":"&lt;"),r=e+1}return n+s.substring(r)}function J(e,t,s=!1){if(null==t||!t&&s||""===t&&"class"===e)return"";return` ${e}${s?"":`="${D(t,!0)}"`}`}function K(e){return"string"==typeof e?e:null==e?"":e+""}function O(e,t){const{children:s}=t;e.out+='<div class="bluesky-embed s-dgn7w7">',s(e),e.out+="</div>"}const Q=e=>`https://bsky.app/profile/${e}`,V={"!hide":{name:"Hidden by moderators",flags:1},"!warn":{name:"Content warning",flags:1},porn:{name:"Adult content",flags:0},sexual:{name:"Sexually suggestive",flags:0},"graphic-media":{name:"Graphic media",flags:0},nudity:{name:"Nudity",flags:0}},W=new Intl.NumberFormat("en-US"),Y=new Intl.NumberFormat("en-US",{notation:"compact"}),ee=e=>e<1e3?""+e:e<1e5?W.format(e):Y.format(e),te=/^https?:\/\//;function se(e,t){const{text:s}=t,a=(e=>{const t=[];let s,a;for(;e;)if(s=a,a=T(e)||H(e)||M(e)||Z(e)||G(e)||L(e))e=e.slice(a.raw.length),t.push(a);else if(a=E(e))e=e.slice(a.raw.length),s&&"text"===s.type?(s.raw+=a.raw,s.text+=a.text,a=s):t.push(a);else if(e)throw new Error("infinite loop encountered");return t})(s);e.out+='<p class="rich-text is-small s-1ea7h2m">';for(let r=0,l=a.length;r<l;r++){let t=a[r];"autolink"===t.type?e.out+=`<a target="_blank"${J("href",t.url)} rel="noopener nofollow" class="link s-1ea7h2m">${D(t.raw.replace(te,""))}</a>`:"mention"===t.type?e.out+=`<a target="_blank"${J("href",Q(t.handle))} class="mention s-1ea7h2m">${D(t.raw)}</a>`:"topic"===t.type?e.out+=`<a target="_blank"${J("href",(n=t.name,`https://bsky.app/hashtag/${n}`))} class="hashtag s-1ea7h2m">${D(t.raw)}</a>`:e.out+=D(t.raw)}var n;e.out+="</p>"}function ae(e,t){const{profile:s}=t,a=Q(s.did),n=((e,t)=>{if(e?.length)for(let s=0,a=e.length;s<a;s++){const a=e[s],n=a.val;if(!(n in V))continue;const r=V[n];if(!(1&r.flags&&a.src===t))return r}})(s.labels,s.did);e.out+='<div class="profile-card has-banner s-2b3fq6"><div class="banner-wrapper s-2b3fq6">',s.banner&&(e.out+=`<img loading="lazy"${J("src",s.banner)} alt=""${J("class",`${K("banner"+(n?" is-blurred":""))} s-2b3fq6`)}>`),e.out+=`</div> <div class="contents s-2b3fq6"><div class="header s-2b3fq6"><a${J("href",a)} target="_blank" class="avatar-wrapper s-2b3fq6">`,s.avatar&&(e.out+=`<img loading="lazy"${J("src",s.avatar)} alt=""${J("class",`${K("avatar"+(n?" is-blurred":""))} s-2b3fq6`)}>`),e.out+=`</a> <div class="actions s-2b3fq6"><a${J("href",a)} target="_blank" class="follow-button s-2b3fq6"><svg class="icon s-2b3fq6" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="M12 4v8m0 0v8m0-8H4m8 0h8"></path></svg> <span>Follow</span></a> <svg class="logo s-2b3fq6" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg></div></div> <div class="name-wrapper"><p dir="auto" class="display-name s-2b3fq6">${D(s.displayName?.trim()||s.handle.slice(0,64))}</p> <p class="handle s-2b3fq6">@${D(s.handle)}</p></div> <div class="stats s-2b3fq6"><span class="stat-entry s-2b3fq6"><span class="stat-count s-2b3fq6">${D(ee(s.followersCount||0))}</span> <span>${D(1===s.followersCount?"Follower":"Followers")}</span></span> <span class="stat-entry s-2b3fq6"><span class="stat-count s-2b3fq6">${D(ee(s.followsCount||0))}</span> <span>Following</span></span></div> `,s.description?.trim()&&se(e,{text:s.description}),e.out+="</div></div>"}function ne(e,t){O(e,{children:e=>{e.out+=`<div class="message s-ibmh3w">${D(t)}</div>`}})}function re(e,t){const{profile:s,allowUnauthenticated:a}=t,n=!a&&s?.labels?.some((e=>"!no-unauthenticated"===e.val));null===s?ne(e,"The profile can't be found, it may have been deleted."):n?ne(e,"The user has requested for their profile to not be displayed on external sites."):O(e,{children:e=>{ae(e,{profile:s})}})}var le=r("<bluesky-profile-card><!></bluesky-profile-card>",2);function oe(r,o){e(o,!0);var i=le(),c=l(i);$(c,(()=>function(e,t){const s={out:""};return re(s,t?.props??{}),{head:"",body:s.out}}(0,{props:o.data}).body)),t((()=>s(i,"actor",o.data.profile?.did))),a(r,i),n()}var ie=r("<li><p>Insert the following scripts and stylesheets to the <code>&lt;head&gt;</code> of your website.</p> <!></li> <li><p>Insert the following markup in wherever you want the profile feed to be.</p> <!></li>",1),ce=r("<!> <!>",1);function pe(s,r){let $;e(r,!0);const A=m((()=>{$?.abort(),$=new AbortController;const e=$.signal;return(async e=>{const t=e.actor,s=e.allowUnauthenticated??!1,a=new w({handler:y({service:e.serviceUri??"https://public.api.bsky.app"})}),{data:n}=await a.get("app.bsky.actor.getProfile",{signal:e.signal,params:{actor:t}}).catch((e=>e instanceof v&&"InvalidRequest"===e.kind&&"Profile not found"===e.description?{data:null}:Promise.reject(e)));return{profile:n,allowUnauthenticated:s}})({actor:r.matched.actor,signal:e})}));k((()=>{$?.abort()}));const P=()=>{const e="https://cdn.jsdelivr.net/npm/bluesky-profile-card-embed@^1.0.0";return`\x3c!-- Core web component and styling --\x3e\n<script type="module" src="${e}/+esm"><\/script>\n<link rel="stylesheet" href="${e}/dist/core.min.css">\n\n\x3c!-- Built-in themes --\x3e\n<link rel="stylesheet" href="${e}/themes/light.min.css" media="(prefers-color-scheme: light)">\n<link rel="stylesheet" href="${e}/themes/dim.min.css" media="(prefers-color-scheme: dark)">\n`};var B=o(),U=i(B);c(U,(()=>f(A)),(e=>{g(e,{})}),((e,t)=>{var s=ce(),n=i(s);oe(n,{get data(){return f(t)}});var r=h(n,2),o=e=>{q(e,{title:"How do I embed this to my website?",children:(e,s)=>{C(e,{children:(e,s)=>{var n=ie(),r=i(n),o=h(l(r),2),c=m(P);F(o,{get code(){return f(c)}}),I(r);var p=h(r,2),d=h(l(p),2),u=m((()=>(e=>{const t=`https://bsky.app/profile/${e.did}`;return`<bluesky-profile-card actor="${N(e.did)}">\n  <a target="_blank" href="${N(t)}" class="bluesky-profile-card-fallback">\n    ${e.displayName?.trim()?`Follow ${N(e.displayName)} (@${N(e.handle)}) on Bluesky`:`Follow @${N(e.handle)} on Bluesky`}\n  </a>\n</bluesky-profile-card>\n`})(f(t).profile)));F(d,{get code(){return f(u)}}),I(p),a(e,n)},$$slots:{default:!0}})},$$slots:{default:!0}})};b(r,(e=>{f(t).profile&&e(o)})),a(e,s)}),((e,s)=>{p(e,{type:"alert",children:(e,n)=>{x();var r=d();t((()=>u(r,""+f(s)))),a(e,r)},$$slots:{default:!0}})})),a(s,B),n()}export{pe as default};
